<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDONI - Fichas T√©cnicas</title>
    <link rel="stylesheet" href="../styles/common.css">
    <link rel="stylesheet" href="recipe-cards.css">
</head>
<body>
    <!-- Header -->
    <div class="recipe-header">
        <h1>
            üë®‚Äçüç≥ Fichas T√©cnicas
            <span style="font-size: 1rem; opacity: 0.8;">| Gesti√≥n de Recetas</span>
        </h1>
        <div class="subtitle">
            Crea y gestiona fichas t√©cnicas profesionales para tus platos
        </div>
        <div class="recipe-nav">
            <button class="nav-button" onclick="window.history.back()">üè† Volver al Men√∫</button>
            <button class="nav-button" onclick="showHelp()">‚ùì Ayuda</button>
            <button class="nav-button" onclick="showShortcuts()">‚å®Ô∏è Atajos</button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Form Content -->
        <div class="form-content">
            <form id="recipe-form">
                <!-- Informaci√≥n del Plato -->
                <div class="form-section">
                    <h3>üçΩÔ∏è Informaci√≥n del Plato</h3>
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="recipe-name">Nombre del Plato:</label>
                            <input type="text" id="recipe-name" required placeholder="Ej: Ensalada Mediterr√°nea">
                        </div>
                    </div>
                </div>

                <!-- Foto del Plato -->
                <div class="form-section">
                    <h3>üì∏ Foto del Plato (opcional)</h3>
                    <div class="image-section">
                        <label for="recipe-image" class="image-upload-label">
                            <div class="image-upload-icon">üì∑</div>
                            <div class="image-upload-text">Haz clic para a√±adir foto</div>
                            <div class="image-upload-subtext">Formatos: JPG, PNG (m√°x. 5MB)</div>
                        </label>
                        <input type="file" id="recipe-image" accept="image/*">
                        <div id="image-preview">
                            <span style="color: #bbb; font-style: italic;">Sin foto seleccionada</span>
                        </div>
                        <button type="button" id="clear-image" class="action-btn btn-secondary" style="margin-top: 1rem; width: auto;">
                            üßπ Limpiar Imagen
                        </button>
                    </div>
                </div>

                <!-- Ingredientes y Costes -->
                <div class="form-section">
                    <h3>ü•ò Ingredientes y Costes</h3>
                    <div class="ingredients-table-container">
                        <table class="ingredients-table">
                            <thead>
                                <tr>
                                    <th>Ingrediente</th>
                                    <th>Peso (g)</th>
                                    <th>Coste (‚Ç¨)</th>
                                    <th>Gastos (‚Ç¨)</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="ingredients-table-body">
                                <tr class="ingredient-row">
                                    <td><input type="text" placeholder="Nombre del ingrediente" class="ingredient-name"></td>
                                    <td><input type="number" placeholder="0" class="ingredient-weight" step="0.1" min="0"></td>
                                    <td><input type="number" placeholder="0.00" class="ingredient-cost" step="0.01" min="0"></td>
                                    <td><input type="number" placeholder="0.00" class="ingredient-expenses" step="0.01" min="0"></td>
                                    <td><button type="button" class="remove-ingredient">üóëÔ∏è</button></td>
                                </tr>
                            </tbody>
                        </table>
                        <button type="button" id="add-ingredient" class="add-ingredient-btn">
                            ‚ûï A√±adir Ingrediente
                        </button>
                    </div>
                </div>

                <!-- Al√©rgenos -->
                <div class="form-section">
                    <h3>‚ö†Ô∏è Al√©rgenos del Plato</h3>
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="recipe-allergens">Al√©rgenos (separados por comas):</label>
                            <input type="text" id="recipe-allergens" placeholder="Ej: Gluten, Lactosa, Frutos secos, Huevos">
                        </div>
                    </div>
                    <div class="allergens-section">
                        <h4>Al√©rgenos Detectados:</h4>
                        <div id="allergens-list">
                            <p style="color: #666; font-style: italic;">No se han especificado al√©rgenos</p>
                        </div>
                    </div>
                </div>

                <!-- Resumen de Costes -->
                <div class="cost-summary">
                    <h4>üí∞ Resumen de Costes</h4>
                    <div class="summary-grid">
                        <div class="summary-item">
                            <div class="summary-label">Total Peso</div>
                            <div class="summary-value" id="total-weight">0 g</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-label">Total Coste</div>
                            <div class="summary-value" id="total-cost">0.00 ‚Ç¨</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-label">Total Gastos</div>
                            <div class="summary-value" id="total-expenses">0.00 ‚Ç¨</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-label">Coste Total</div>
                            <div class="summary-value" id="grand-total">0.00 ‚Ç¨</div>
                        </div>
                    </div>
                </div>

                <!-- Acciones del Formulario -->
                <div class="form-actions">
                    <button type="submit" class="action-btn btn-primary">
                        üíæ Guardar Ficha
                    </button>
                    <button type="button" id="save-and-new" class="action-btn btn-success">
                        üíæ‚ûï Guardar y Nueva
                    </button>
                    <button type="button" id="new-recipe" class="action-btn btn-secondary">
                        üÜï Nueva Ficha
                    </button>
                    <button type="reset" class="action-btn btn-secondary">
                        üóëÔ∏è Limpiar
                    </button>
                </div>
            </form>

            <!-- Historial de Fichas -->
            <div class="history-section">
                <div class="history-header">
                    <div class="history-title">üìö Historial de Fichas</div>
                    <input type="text" class="history-search" id="history-search" placeholder="Buscar en el historial...">
                </div>
                <div class="history-table-container">
                    <table class="history-table">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Ingredientes</th>
                                <th>Coste Total</th>
                                <th>Fecha</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="history-table-body">
                            <tr>
                                <td colspan="5" style="text-align: center; color: #666; font-style: italic; padding: 2rem;">
                                    No hay fichas t√©cnicas guardadas
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="sidebar">
            <!-- Acciones R√°pidas -->
            <div class="sidebar-section">
                <div class="sidebar-title">‚ö° Acciones R√°pidas</div>
                <div style="display: flex; flex-direction: column; gap: 0.8rem;">
                    <button class="action-btn btn-export" id="export-recipe" disabled>
                        üìÑ Exportar HTML
                    </button>
                    <button class="action-btn btn-print" id="print-recipe" disabled>
                        üñ®Ô∏è Imprimir
                    </button>
                    <button class="action-btn btn-success" id="duplicate-recipe" disabled>
                        üìã Duplicar
                    </button>
                </div>
            </div>

            <!-- Estad√≠sticas -->
            <div class="sidebar-section">
                <div class="sidebar-title">üìä Estad√≠sticas</div>
                <div style="font-size: 0.9rem; color: #666; line-height: 1.4;">
                    <p>‚Ä¢ Fichas guardadas: <span id="recipe-count">0</span></p>
                    <p>‚Ä¢ Ingredientes totales: <span id="ingredients-count">0</span></p>
                    <p>‚Ä¢ Coste promedio: <span id="avg-cost">0.00 ‚Ç¨</span></p>
                    <p>‚Ä¢ √öltima modificaci√≥n: <span id="last-modified">-</span></p>
                </div>
            </div>

            <!-- Informaci√≥n -->
            <div class="sidebar-section">
                <div class="sidebar-title">‚ÑπÔ∏è Informaci√≥n</div>
                <div style="font-size: 0.85rem; color: #666; line-height: 1.4;">
                    <p>‚Ä¢ Los datos se guardan autom√°ticamente</p>
                    <p>‚Ä¢ Usa Ctrl+S para guardar r√°pidamente</p>
                    <p>‚Ä¢ Ctrl+N para nueva ficha</p>
                    <p>‚Ä¢ Ctrl+D para duplicar seleccionada</p>
                    <p>‚Ä¢ Escape para limpiar selecci√≥n</p>
                </div>
            </div>

            <!-- Vista Previa -->
            <div class="sidebar-section">
                <div class="sidebar-title">üëÅÔ∏è Vista Previa</div>
                <div id="recipe-preview" style="background: white; border-radius: 10px; padding: 1rem; border: 1px solid #e1efd6;">
                    <div id="preview-content">
                        <p style="color: #666; font-style: italic; text-align: center;">Vista previa no disponible</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="recipe-cards.js"></script>
    <script>
        function showHelp() {
            alert(`üë®‚Äçüç≥ GU√çA DE FICHAS T√âCNICAS

üéØ FUNCIONES PRINCIPALES:
‚Ä¢ Crear fichas t√©cnicas completas
‚Ä¢ Gestionar ingredientes y costes
‚Ä¢ A√±adir fotos de los platos
‚Ä¢ Control de al√©rgenos autom√°tico
‚Ä¢ Historial completo de fichas

üìã CREACI√ìN DE FICHAS:
‚Ä¢ Nombre del plato (obligatorio)
‚Ä¢ Foto opcional (m√°x. 5MB)
‚Ä¢ Ingredientes con peso y costes
‚Ä¢ Al√©rgenos separados por comas
‚Ä¢ C√°lculo autom√°tico de costes

üíæ GESTI√ìN:
‚Ä¢ Guardado autom√°tico cada 30s
‚Ä¢ Historial con b√∫squeda
‚Ä¢ Duplicaci√≥n de fichas
‚Ä¢ Exportaci√≥n a HTML
‚Ä¢ Impresi√≥n directa

üí° CONSEJOS:
‚Ä¢ Usa Ctrl+S para guardar r√°pido
‚Ä¢ Ctrl+N para nueva ficha
‚Ä¢ Ctrl+D para duplicar
‚Ä¢ Escape para limpiar selecci√≥n
‚Ä¢ Los datos se sincronizan autom√°ticamente`);
        }

        function showShortcuts() {
            alert(`‚å®Ô∏è ATAJOS DE TECLADO

üíæ GUARDADO:
‚Ä¢ Ctrl+S: Guardar ficha actual
‚Ä¢ Ctrl+N: Crear nueva ficha
‚Ä¢ Ctrl+D: Duplicar ficha seleccionada

üîç NAVEGACI√ìN:
‚Ä¢ Escape: Limpiar selecci√≥n del historial
‚Ä¢ Tab: Navegar entre campos
‚Ä¢ Enter: Aplicar filtros

üìÑ EXPORTACI√ìN:
‚Ä¢ Bot√≥n Exportar: Generar HTML
‚Ä¢ Bot√≥n Imprimir: Vista de impresi√≥n
‚Ä¢ Historial: Acceso r√°pido a fichas

üéØ CONSEJOS:
‚Ä¢ Los atajos funcionan en cualquier momento
‚Ä¢ Los datos se guardan autom√°ticamente
‚Ä¢ Usa el historial para acceder r√°pido
‚Ä¢ Duplica fichas para variaciones`);
        }
    </script>
</body>
</html> 